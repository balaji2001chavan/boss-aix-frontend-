async function send(){
  const text = msg.value;
  msg.value = "";

  add("You: " + text, "you");

  const payload = lastPlan
    ? { message: text, approve: true }
    : { message: text };

  try {
    const r = await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await r.json();

    // ✅ THIS IS THE FIX
    if (data.text) {
      add("Boss AIX: " + data.text, "boss");
    } else {
      add("Boss AIX: (रिकामा प्रतिसाद)", "boss");
    }

    if (data.step === "PLAN") {
      lastPlan = true;
      add("Boss AIX: " + data.ask, "boss");
    } else {
      lastPlan = false;
    }

  } catch (e) {
    add("❌ Backend reachable नाही", "boss");
  }
}
